# 🔄 软件更新和功能扩展指南

## 方法一：GitHub在线编辑（推荐新手）

### 优势
- ✅ 无需本地开发环境
- ✅ 随时随地修改
- ✅ 自动部署更新
- ✅ 修改历史记录

### 操作步骤
1. **访问GitHub仓库**
   - 打开 `https://github.com/你的用户名/fund-management`
   - 找到要修改的文件（如 `app.py`）

2. **在线编辑**
   - 点击文件名进入文件详情
   - 点击右上角的 "✏️ 编辑" 按钮
   - 直接修改代码

3. **提交更改**
   - 拉到页面底部
   - 填写提交说明：如 "新增XX功能"
   - 点击 "Commit changes"

4. **自动部署**
   - Streamlit Cloud会自动检测到更改
   - 约2-3分钟后，网站自动更新

### 示例：添加新功能
```python
# 在 app.py 中添加新的侧边栏选项
page = st.sidebar.selectbox(
    "选择功能页面",
    ["📊 数据概览", "🎯 策略管理", "📝 净值录入", 
     "👥 投资人管理", "📦 产品管理", "📈 图表分析",
     "📋 报表导出"]  # 新增功能
)

# 添加新功能页面
elif page == "📋 报表导出":
    st.header("报表导出")
    
    # 导出净值报表
    if st.button("导出净值报表"):
        nav_data = db.get_nav_records()
        csv = nav_data.to_csv(index=False)
        st.download_button(
            label="下载CSV文件",
            data=csv,
            file_name=f"净值报表_{datetime.now().strftime('%Y%m%d')}.csv",
            mime="text/csv"
        )
```

## 方法二：本地开发（推荐进阶）

### 优势
- ✅ 完整开发环境
- ✅ 可以测试调试
- ✅ 复杂功能开发
- ✅ 版本控制

### 环境设置
```bash
# 1. 克隆仓库到本地
git clone https://github.com/你的用户名/fund-management.git
cd fund-management

# 2. 创建开发环境
conda create -n fund_dev python=3.9
conda activate fund_dev
pip install -r requirements.txt

# 3. 本地测试
streamlit run app.py
```

### 开发流程
```bash
# 1. 创建功能分支
git checkout -b feature/new-reports

# 2. 修改代码
# 编辑 app.py, database.py 等文件

# 3. 本地测试
streamlit run app.py

# 4. 提交更改
git add .
git commit -m "新增报表导出功能"

# 5. 推送到GitHub
git push origin feature/new-reports

# 6. 创建Pull Request
# 在GitHub网站上合并到主分支

# 7. 自动部署
# Streamlit Cloud检测到主分支更新，自动部署
```

## 方法三：协作开发

### 团队开发流程
```bash
# 合伙人A开发新功能
git checkout -b feature/risk-analysis
# 修改代码...
git push origin feature/risk-analysis

# 合伙人B开发另一功能  
git checkout -b feature/mobile-ui
# 修改代码...
git push origin feature/mobile-ui

# 项目负责人审核并合并
# 在GitHub上review并merge
```

## 🚀 常见功能扩展示例

### 1. 添加数据导出功能
```python
# 在 app.py 中添加
def export_data():
    """数据导出功能"""
    st.subheader("数据导出")
    
    export_type = st.selectbox("选择导出类型", 
                              ["净值数据", "投资记录", "策略汇总"])
    
    if st.button("导出"):
        if export_type == "净值数据":
            data = db.get_nav_records()
        elif export_type == "投资记录":
            data = db.get_investor_investments()
        else:
            data = db.get_strategies()
        
        csv = data.to_csv(index=False)
        st.download_button(
            label="下载CSV文件",
            data=csv,
            file_name=f"{export_type}_{datetime.now().strftime('%Y%m%d')}.csv",
            mime="text/csv"
        )
```

### 2. 添加风险指标计算
```python
# 在 database.py 中添加
def calculate_risk_metrics(self, strategy_id):
    """计算风险指标"""
    nav_data = self.get_nav_records(strategy_id)
    
    if len(nav_data) < 2:
        return {}
    
    returns = nav_data['return_rate'].dropna() / 100
    
    metrics = {
        'volatility': returns.std() * np.sqrt(252),  # 年化波动率
        'sharpe_ratio': returns.mean() / returns.std() * np.sqrt(252),
        'max_drawdown': self._calculate_max_drawdown(nav_data),
        'var_95': returns.quantile(0.05)  # 95% VaR
    }
    
    return metrics

def _calculate_max_drawdown(self, nav_data):
    """计算最大回撤"""
    nav_values = nav_data['nav_value']
    peak = nav_values.expanding().max()
    drawdown = (nav_values - peak) / peak
    return drawdown.min()
```

### 3. 添加移动端适配
```python
# 在 app.py 开头添加
def is_mobile():
    """检测是否为移动设备"""
    return st.session_state.get('mobile_device', False)

# 响应式布局
if is_mobile():
    # 移动端布局：单列
    col1 = st.container()
else:
    # 桌面端布局：多列
    col1, col2, col3 = st.columns(3)
```

## 📱 实时更新监控

### 查看部署状态
1. **Streamlit Cloud控制台**
   - 访问 `https://share.streamlit.io`
   - 查看应用状态和日志

2. **GitHub Actions（可选）**
```yaml
# .github/workflows/deploy.yml
name: Auto Deploy
on:
  push:
    branches: [main]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Streamlit Deploy
        run: echo "Streamlit will auto-deploy"
```

## 🔧 开发工具推荐

### 1. 代码编辑器
- **VS Code**：免费，插件丰富
- **PyCharm**：专业Python IDE
- **GitHub Codespaces**：云端开发环境

### 2. 版本控制
- **GitHub Desktop**：图形化Git工具
- **SourceTree**：可视化Git管理

### 3. 在线工具
- **GitHub Web Editor**：按 `.` 键进入在线VS Code
- **CodePen**：快速原型验证

## 📋 功能扩展建议

### 优先级1（易于实现）
- [ ] 数据导出/导入
- [ ] 基础图表定制
- [ ] 简单报表生成
- [ ] 用户界面优化

### 优先级2（中等难度）
- [ ] 风险指标计算
- [ ] 高级图表分析
- [ ] 邮件通知功能
- [ ] 移动端优化

### 优先级3（较复杂）
- [ ] 用户权限管理
- [ ] 实时数据同步
- [ ] 高级报表模板
- [ ] API接口开发

## 💡 最佳实践

### 开发建议
1. **小步快跑**：每次只添加一个小功能
2. **先测试**：本地测试无误再推送
3. **备份数据**：重要更改前备份数据库
4. **文档更新**：新功能要更新说明文档

### 团队协作
1. **分工明确**：不同人负责不同模块
2. **代码审查**：重要更改需要review
3. **定期同步**：每周同步开发进度
4. **版本发布**：重要更新打tag发布

---

选择适合您团队的开发方式，逐步扩展系统功能！
